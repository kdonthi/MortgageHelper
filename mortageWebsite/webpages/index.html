<!DOCTYPE html>
<html>
    <head>
        <title>Landis Customer Information</title>
        <style>
            body {
                background-color: white;
                font-family: "SansSerif";
                height: 100%;
                width: 100%;
            }
            .intro {
                text-align: center;
            }
            p {
                font-size: 20px;
            }

            .container {
                position: relative;
                display: inline-block;
                width: 200px;
                height: 300px;
                margin: 30px 15px 10px 30px;
            }

            .card {
                position: absolute;
                width: 100%;
                height: 100%;
                transform-style: preserve-3d;
                transition: all 0.5s ease-out;
                perspective: 1000px;
            }

            .container:hover > .card{
                transform: rotateY(180deg);
            }

            .frontOfCard {
                background-color: grey;
                position: absolute;
                width: 100%;
                height: 100%;
                backface-visibility: hidden;
                z-index: 1;
            }

            .backOfCard {
                background-color: coral;
                position: absolute;
                width: 100%;
                height: 100%;
                backface-visibility: hidden;
                transform: rotateY(180deg);
            }

            img {
                width: 40%;
                align-content: center;
            }

        </style>
    </head>
    <body>
        <h1 class="intro"><i>Landis's Valued Customers</i></h1>
        <p class="intro">Here at Landis, we believe that everyone should have the right to own property and pursue their American Dream.
            <br><br>
            That's why our world-class engineers strive to create tools to help people, no matter their financial status, to achieve it. Here are a few of our happy customers.
        </p>
        <div id="tileContainer">

        </div>
        <script type="text/javascript">
            let baseUrl = "http://localhost:3000"
            async function getPeopleCount() {
                return await fetch(baseUrl + "/people/count");
            }

            async function getProperty(number, property) {
                return await fetch(baseUrl + `/people/${number}/${property}`);
            }

            async function getDivWithHtml(className, number) {
                let div = getDiv(className, number);
                let obj = await getProperty(number, className);
                let jsonObj = await obj.json();
                div.innerHTML = jsonObj[0][className];
                return div;
            }
            async function addPersonalInformation(divElement, number) {
                let firstNameDiv = await getDivWithHtml("name_first", number);
                let lastNameDiv = await getDivWithHtml("name_last", number);
                let emailDiv = await getDivWithHtml("email", number);
                let imgDiv = document.createElement("img");

                divElement.appendChild(firstNameDiv);
                divElement.appendChild(lastNameDiv);
                divElement.appendChild(emailDiv);
                imgDiv.id = "img" + number;
                getProperty(number, "picture")
                    .then(obj => obj.json())
                    .then(pictureObj => {
                    imgDiv.src = pictureObj[0].picture;
                    divElement.appendChild(imgDiv);
                });
            }

            function addIndicatorInformation(divElement, number) {

            }
            function getDiv(className, number) {
                let divElement = document.createElement("div");
                if (className === "frontOfCard") {
                    console.log("In equality")
                    addPersonalInformation(divElement, number);
                }
                if (className === "backOfCard") {
                    addIndicatorInformation(divElement, number);
                }
                divElement.id = className + number.toString();
                divElement.classList.add(className); //can only add one?
                return divElement;
            }

            function addTiles() {
                getPeopleCount()
                    .then(people => {return people.json();})
                    .then(count => {
                        let intCount = parseInt(JSON.stringify(count));
                        let tileContainer = document.getElementById("tileContainer");
                        for (let i = 1; i <= intCount; i++) {
                            let container = getDiv("container", i);
                            let card = getDiv("card", i);
                            let frontOfCard = getDiv("frontOfCard", i);
                            let backOfCard = getDiv("backOfCard", i);
                            tileContainer.appendChild(container);
                            container.appendChild(card);
                            card.appendChild(frontOfCard);
                            card.appendChild(backOfCard);

                        }
                        console.log("Tiles finished adding.");
                    })
                    .catch(error => console.log("Error in adding tiles.", error));
            }
            addTiles();
        </script>
    </body>

</html>